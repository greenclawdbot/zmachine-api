// methods shared across multiple modules
import { BIT_15, BIT_16 } from './constants';
export function calculateChecksum(file) {
    const version = file[0];
    const lengthWord = (file[26] * 256) + file[27];
    let fileLength;
    if (version < 4) {
        fileLength = 2 * lengthWord;
    }
    else if (version < 6) {
        fileLength = 4 * lengthWord;
    }
    else {
        fileLength = 8 * lengthWord;
    }
    let total = 0;
    for (let i = 64; i < fileLength && i < file.length; i += 1) {
        total += file[i];
    }
    return total % BIT_16;
}
export function makeColorCode(color) {
    if (color < 0 || color >= BIT_15) {
        throw new Error(`color out of range ${color}`);
    }
    // converts a fifteen bit color into a html color code #rrggbb
    const bits15 = (color).toString(2).padStart(15, '0');
    const bits24 = (bits15.slice(10, 15) + bits15.slice(10, 13)
        + bits15.slice(5, 10) + bits15.slice(5, 8)
        + bits15.slice(0, 5) + bits15.slice(0, 3));
    const num = Number.parseInt(bits24, 2);
    return `#${num.toString(16).padStart(6, '0')}`;
}
